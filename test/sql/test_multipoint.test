# name: test/sql/test_multipoint.test
# description: MULTIPOINT tests
# group: [sql]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE geometries (g Geometry);

# Insert valid geometry strings
statement ok
INSERT INTO geometries VALUES('010400000002000000010100000000000000000008400000000000001040010100000000000000000020400000000000002240'), ('0104000000050000000101000000C887B40B78CC4940E443DA053C2653400101000000C887B40B788C5340AC87B40B78CC5940010100000053E1945C75085A40E4F893E2E54B60400101000000AA704AAE3AC45F4072FC49F1F205644001010000000000000000C062400000000000C06740'), ('0104000080020000000101000080000000000000594000000000000059400000000000003E400101000080000000000000494000000000008052400000000000408F40'), ('0104000080020000000101000080000000000000594000000000000059400000000000003E400101000080000000000000494000000000008052400000000000408F40')

query T
SELECT * FROM geometries
----
010400000002000000010100000000000000000008400000000000001040010100000000000000000020400000000000002240
0104000000050000000101000000C887B40B78CC4940E443DA053C2653400101000000C887B40B788C5340AC87B40B78CC5940010100000053E1945C75085A40E4F893E2E54B60400101000000AA704AAE3AC45F4072FC49F1F205644001010000000000000000C062400000000000C06740
0104000080020000000101000080000000000000594000000000000059400000000000003E400101000080000000000000494000000000008052400000000000408F40
0104000080020000000101000080000000000000594000000000000059400000000000003E400101000080000000000000494000000000008052400000000000408F40

query T
SELECT ST_ASTEXT(g) FROM geometries
----
MULTIPOINT(3 4,8 9)
MULTIPOINT(51.5974135047432 76.5974135047432,78.1948270094864 103.194827009486,104.132163186446 130.37181214238,127.066081593223 160.18590607119,150 190)
MULTIPOINT Z (100 100 30,50 74 1000)
MULTIPOINT Z (100 100 30,50 74 1000)

statement error
INSERT INTO geometries(('0104000000020000000101000000000000000000084000000000000010400101000000000000000000204000000000000022402'))

# Insert valid strings with text
statement ok
DELETE FROM geometries

statement ok
INSERT INTO geometries VALUES('MULTIPOINT(3 4,8 9,123.43 45.21)'), ('MULTIPOINT(51.597413504 76.59741350472,78.19482700294864 103.19482700486,104.132163186446 130.37181214238,127.066081593223 160.18590607119,150 190)'), ('MULTIPOINT(100 100.01 30, 50 74.44 1000.1)')

query T
SELECT * FROM geometries
----
0104000000030000000101000000000000000000084000000000000010400101000000000000000000204000000000000022400101000000EC51B81E85DB5E407B14AE47E19A4640
010400000005000000010100000034EFB20B78CC4940833DDA053C2653400101000000B282AD0B788C53401690AF0B78CC5940010100000053E1945C75085A40E4F893E2E54B60400101000000AA704AAE3AC45F4072FC49F1F205644001010000000000000000C062400000000000C06740
01040000800200000001010000800000000000005940713D0AD7A30059400000000000003E40010100008000000000000049405C8FC2F5289C5240CDCCCCCCCC408F40

query T
SELECT ST_ASTEXT(g) FROM geometries
----
MULTIPOINT(3 4,8 9,123.43 45.21)
MULTIPOINT(51.597413504 76.59741350472,78.19482700294864 103.19482700486,104.132163186446 130.37181214238,127.066081593223 160.18590607119,150 190)
MULTIPOINT Z (100 100.01 30,50 74.44 1000.1)

statement error
INSERT INTO geometries(('MULTIPOINT(-71.064544 42.28787)'))

# Insert valid strings with geojson
statement ok
DELETE FROM geometries

statement ok
INSERT INTO geometries VALUES('{"type":"MultiPoint","coordinates":[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]]}'), ('{"type":"MultiPoint","coordinates":[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]}'), ('{"type":"MultiPoint","coordinates":[[10,43.28787]]}')

query T
SELECT * FROM geometries
----
01040000002B00000001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000005DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC0000000000000404001010000000000000000405DC00000000000004040
01040000000700000001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000080404001010000000000000000405DC0000000000000404001010000000000000000405DC00000000000804040
01040000000100000001010000000000000000002440F0BF95ECD8A44540

query T
SELECT ST_ASTEXT(g) FROM geometries
----
MULTIPOINT(-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 32,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 33,-117 32,-117 32,-117 32,-117 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-116 32,-117 32,-117 32,-117 32,-117 32)
MULTIPOINT(-117 33,-117 33,-117 33,-117 33,-117 33,-117 32,-117 33)
MULTIPOINT(10 43.28787)

# Insert invalid geojson string
statement error
INSERT INTO geometries(('{"type":"MultiPoint","coordinates":[[30,10.2323]}'))
