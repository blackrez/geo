# name: test/sql/test_distance.test
# description: ST_DISTANCE test
# group: [sql]

statement ok
LOAD 'build/release/extension/geo/geo.duckdb_extension';

statement ok
PRAGMA enable_verification

#test with POINT
#to POINT
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'POINT(-71.04096 42.285752)', false)
----
1954.2758204

#to LINESTRING
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', true)
----
87332.6399146

#to POLYGON
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571))', false)
----
14698.8047527

#to MULTIPOINT
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'MULTIPOINT(-70.9590 42.1180, -70.9611 42.1223)', false)
----
20286.5956982

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'MULTILINESTRING((-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))')
----
8517.5097174

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('POINT(-110 30)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
613475.213186

#to COLLECTION
query I
SELECT ST_DISTANCE('POINT(-71.064544 42.28787)', 'GEOMETRYCOLLECTION(POINT(-71.04096 42.285752),POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', true)
----
1959.3294247

#test with LINESTRING
#to POINT
query I
SELECT ST_DISTANCE('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 195)', 'POINT(35.3933982822018 35.3933982822018)')
----
0.0

#to LINESTRING
query I
SELECT ST_DISTANCE('LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237,31 46,31 195)', 'LINESTRING(164 31,46 31,40.2597485145236 32.1418070123307)')
----
0.0

#to POLYGON
query I
SELECT ST_DISTANCE('LINESTRING(50 75 1000,100 100 30)', '{"type":"Polygon","coordinates":[[[0,0],[0,150],[150,150],[150,0],[0,0]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
1160063.6779029

#to MULTIPOINT
query I
SELECT ST_DISTANCE('LINESTRING(50 75 1000,100 100 30)', 'MULTIPOINT(164 31,46 31, 35.3933982822018 35.3933982822018, 32.1418070123307 40.2597485145237)')
----
3968091.8472333

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('LINESTRING(50 75 1000,100 100 30)', 'MULTILINESTRING((164 31,60 31),(46 31,40.2597485145236 32.1418070123307,35.3933982822018 35.3933982822018,32.1418070123307 40.2597485145237,31 46,31 195))')
----
3351123.3146666

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)', 'MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))')
----
7687.8721069

#to COLLECTION
query I
SELECT ST_DISTANCE('LINESTRING(-72.1260 42.45, -72.123 42.1546)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)), POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)))', false)
----
78279.7082732

#test with POLYGON
#to POINT
query I
SELECT ST_DISTANCE('POLYGON((0 0,0 100,100 200, 200 200, 200 100, 100 100,100 0, 0 0))', 'POINT(-50 -50)')
----
7293897.148747

#to LINESTRING
query I
SELECT ST_DISTANCE('POLYGON((0 0,0 100,100 200, 200 200, 200 100, 100 100,100 0, 0 0))', 'LINESTRING(-1 0, 3 3, 50 50, 100 10)')
----
0.0

#to POLYGON
query I
SELECT ST_DISTANCE('POLYGON((175 150 5, 20 40 5, 35 45 5, 50 60 5, 100 100 5, 175 150 5))', '{"type":"Polygon","coordinates":[[[0,0],[0,170],[-170,170],[-170,0],[0,0]]]}')
----
2321461.7808012

#to MULTIPOINT
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOINT(-70.9590 42.1180, -70.9611 42.1223)', false)
----
31022.4224881

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTILINESTRING((-72.1260 42.45, -72.123 42.1546),(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
10527.3909664

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))')
----
6998.7382883

#to COLLECTION
query I
SELECT ST_DISTANCE('POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675))', 'GEOMETRYCOLLECTION(POLYGON((-71.17166 42.353675,-71.172026 42.354044,-71.17239 42.354358,-71.171794 42.354971,-71.170511 42.354855,-71.17112 42.354238,-71.17166 42.353675)),LINESTRING(-71.17166 42.353675,-71.172026 42.354044,-71.160837 42.259113,-71.161144 42.25932))', true)
----
0.0

#test with MULTIPOINT
#to POINT
query I
SELECT ST_DISTANCE('MULTIPOINT(60 120,110 120,160 120)', 'POINT(111 120)')
----
55597.0106154

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTIPOINT(60 120,110 120,160 120)', 'LINESTRING(60 121,110 121)')
----
103251.8645055

#to POLYGON
query I
SELECT ST_DISTANCE('MULTIPOINT(-60 125, -150 150)', '{"type":"Polygon","coordinates":[[[60,120],[0,150],[150,150],[150,0],[60,120]],[[20,20],[50,20],[50,50],[20,50],[20,20]]]}')
----
4986442.5332375

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTIPOINT(60 120,110 120,160 120)', 'MULTIPOINT(115 120, 165 120)')
----
277921.5352982

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044)', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}', false)
----
2037389.0696161

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTIPOINT(60 120,110 120,160 120)', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
6502843.7482099

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTIPOINT(-71.040878 42.285678,-71.040943 42.2856)', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044))', false)
----
0.0

#test with MULTILINESTRING
#to POINT
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'POINT(1190 110)')
----
124114.4137218

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'LINESTRING(0 0,30 20)')
----
1265090.8453009

#to POLYGON
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'POLYGON((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88, 106 164))')
----
0.0

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'MULTIPOINT(132 178,134 148,128 136,96 128,156 164,146 178,132 186,92 182,56 158,36 150)')
----
0.0

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'MULTILINESTRING((175 155 2, 20 40 20, 50 60 -2, 125 100 1, 175 155 1), (1 10 2, 5 20 1))')
----
0.0

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', '{"type":"MultiPolygon","coordinates":[[[[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,32],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,32],[-117,32],[-117,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-116,32],[-117,32],[-117,32],[-117,32],[-117,32]],[[-117,33],[-117,33],[-117,33],[-117,33],[-117,33],[-117,32],[-117,33]]]]}')
----
4800138.8536908

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTILINESTRING((106 164,30 112,74 70,82 112,130 94,130 62,122 40,156 32,162 76,172 88),(132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88),(22 64,66 28,94 38,94 68,114 76,112 30,132 10,168 18,178 34,186 52,184 74,190 100,190 122,182 148,178 170,176 184,156 164,146 178,132 186,92 182,56 158,36 150,62 150,76 128,88 118))', 'GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(100 100),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
0.0

#test with MULTIPOLYGON
#to POINT
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((26 125, 26 200, 126 200, 126 125, 26 125),(51 150, 101 150, 76 175, 51 150 )),((151 100, 151 200, 176 175, 151 100)))', 'POINT(26 -20)')
----
0.0

#to LINESTRING
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932)', false)
----
7687.8721069

#to POLYGON
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((26 125,26 200,126 200,126 125,101 100,26 125),(51 150,101 150,76 175,51 150)),((151 100,151 200,176 175,151 100)))', 'POLYGON((132 178,134 148,128 136,96 128,132 108,150 130,170 142,174 110,156 96,158 90,158 88, 132 178))')
----
0.0

#to MULTIPOINT
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((26 125,26 200,126 200,126 125,101 100,26 125),(51 150,101 150,76 175,51 150)),((151 100,151 200,176 175,151 100)))', 'MULTIPOINT(26 250, 151 10)')
----
0.0

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', '{"type":"MultiLineString","coordinates":[[[-89.734634999999997,31.492072000000000],[-89.734955999999997,31.492237999999997]]]}', true)
----
2041683.2942281

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((26 125,26 200,126 200,126 125,101 100,26 125),(51 150,101 150,76 175,51 150)),((151 100,151 200,176 175,151 100)))', 'MULTIPOLYGON(((26 125,26 200,126 200,126 125,101 100,26 125),(51 150,101 150,76 175,51 150)))')
----
0.0

#to COLLECTION
query I
SELECT ST_DISTANCE('MULTIPOLYGON(((-71.1031880899493 42.3152774590236,-71.1031627617667 42.3152960829043,-71.102923838298 42.3149156848307,-71.1023097974109 42.3151969047397,-71.1019285062273 42.3147384934248,-71.102505233663 42.3144722937587,-71.10277487471 42.3141658254797,-71.103113945163 42.3142739188902,-71.10324876416 42.31402489987,-71.1033002961013 42.3140393340215,-71.1033488797549 42.3139495090772,-71.103396240451 42.3138632439557,-71.1041521907712 42.3141153348029,-71.1041411411543 42.3141545014533,-71.1041287795912 42.3142114839058,-71.1041188134329 42.3142693656241,-71.1041112482575 42.3143272556118,-71.1041072845732 42.3143851580048,-71.1041057218871 42.3144430686681,-71.1041065602059 42.3145009876017,-71.1041097995362 42.3145589148055,-71.1041166403905 42.3146168544148,-71.1041258822717 42.3146748022936,-71.1041375307579 42.3147318674446,-71.1041492906949 42.3147711126569,-71.1041598612795 42.314808571739,-71.1042515013869 42.3151287620809,-71.1041173835118 42.3150739481917,-71.1040809891419 42.3151344119048,-71.1040438678912 42.3151191367447,-71.1040194562988 42.3151832057859,-71.1038734225584 42.3151140942995,-71.1038446938243 42.3151006300338,-71.1038315271889 42.315094347535,-71.1037393329282 42.315054824985,-71.1035447555574 42.3152608696313,-71.1033436658644 42.3151648370544,-71.1032580383161 42.3152269126061,-71.103223066939 42.3152517403219,-71.1031880899493 42.3152774590236)),((-71.1043632495873 42.315113108546,-71.1043583974082 42.3151211109857,-71.1043443253471 42.3150676015829,-71.1043850704575 42.3150793250568,-71.1043632495873 42.315113108546)))', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
5960.8112207

#test with COLLECTION
#to POINT
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(100 100),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POINT(150 100)')
----
935938.4419624

#to LINESTRING
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', 'LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546)', true)
----
79393.821299

#to POLYGON
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(25 169),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'POLYGON((1 -1, 4 -1, 4 -4, 1 -4, 1 -1))')
----
2677864.5643269

#to MULTIPOINT
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOINT(25 175,-78.26 40.98)')
----
667170.4784078

#to MULTILINESTRING
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1235 42.3521),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTILINESTRING((-72.1260 42.45, -72.123 42.1546),(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932))', false)
----
0.0

#to MULTIPOLYGON
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(25 169),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )', 'MULTIPOLYGON(((26 125,26 200,126 200,126 125,101 100,26 125),(51 150,101 150,76 175,51 150)))')
----
0.0

#to COLLECTION
query I
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(-72.1260 42.45, -72.1240 42.45666, -72.123 42.1546), POINT(-72.1240 42.45666),POLYGON((-71.1776585052917 42.3902909739571,-71.1776820268866 42.3903701743239,-71.1776063012595 42.3903825660754,-71.1775826583081 42.3903033653531,-71.1776585052917 42.3902909739571)) )', 'GEOMETRYCOLLECTION(POLYGON((-71.040878 42.285678,-71.040943 42.2856,-71.04096 42.285752,-71.040878 42.285678)),LINESTRING(-71.160281 42.258729,-71.160837 42.259113,-71.161144 42.25932),MULTIPOINT(-71.17166 42.353675,-71.172026 42.354044))', false)
----
4056.9577619

#test with NULL and empty value
query I
SELECT ST_DISTANCE('', 'GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(25 169),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')
----
0.0

query I 
SELECT ST_DISTANCE(NULL, NULL)
----
NULL

# test with invalid input
statement error
SELECT ST_DISTANCE(22, 'GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(25 169),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

statement error
SELECT ST_DISTANCE('GEOMETRYCOLLECTION(LINESTRING(25 169,89 114,40 70,86 43), POINT(25 169),POLYGON((78.26 40.98,83.98 50.74,86 43,78.26 40.98)) )')

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('MULTIPOINT(89 114,0.9 0.9,0.9 0.9,1.9 0.9,0.9 1.9,0.9 0.9)'::GEOGRAPHY), ('LINESTRING(25 169,89 114,40 70,86 43)'::GEOGRAPHY), ('01010000000f48c2be9dc251c0e597c11891244540'), ('POLYGON((25 169,10 4096,10 4091,25 169))'::GEOGRAPHY), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_DISTANCE(g, 'POINT(-50 50)') FROM geographies
----
6653289.2819713
4887936.3326475
1825195.0717544
4215223.721974
1764790.7535486

statement ok
INSERT INTO geographies VALUES(''::GEOGRAPHY), (NULL::GEOGRAPHY), ('POINT(-71.102923838298 42.3149156848307)')

query R
SELECT ST_DISTANCE(g, 'POINT(-71.17239 42.354358)') FROM geographies
----
7846651.8584385
6359686.5826129
13237.5602764
6043233.9314175
104173.9111539
0.0
NULL
7199.9369743
